---
title: A Case for ALL CAPS
author: Alicia Brown
date: '2020-12-23'
slug: a-case-for-allcaps
categories:
  - datatable
  - case
  - sort
  - r
tags:
  - datatable
  - setorder
  - tidyverse
  - arrange
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>Recently I resumed PPE allocation duties for a couple of weeks and took the opportunity to automate a checklist of the orders sorted by region to help with their packaging for delivery. As a data person, I couldn’t help but also sort the names of facilities after region. The resulting data surprised me when I noticed that the secondary sort by facility names placed facilities with names in ALL CAPS before other facilities with Title Case names.</p>
<p>This led me to wonder -</p>
<ol style="list-style-type: decimal">
<li>Do different libraries sort character values differently? I’m typically on #TeamDataverse because <a href="https://dplyr.tidyverse.org/">dplyr</a> makes it a snap to do things and just make sense to human brains.</li>
<li>Is there an advantage to use ALL CAPS if there’s a chance to be sorted first in a mixed case data environment? As someone whose first and last names are at the beginning of the alphabet, I have wondered whether that’s been an advantage to me or if I’ve been lucky on the occasions where I was selected in contests and seat upgrades.</li>
</ol>
<div id="a-review-of-the-data" class="section level2">
<h2>A review of the data</h2>
<p>This data was downloaded from the Washington State Department of Social and Health Services <a href="https://fortress.wa.gov/dshs/adsaapps/Lookup/NHAdvLookup.aspx">website</a> filtered for Nursing facilities in King County. When the search results are returned by the website, it is sorted by facility name as one would expect, where the case does not matter, though it would be nice if the names could have been consistently formatted and makes me wonder about how the data gets to the state. Does one data entry person enter names in ALL CAPS or do the providers enter their names in ALL CAPS? All other data fields across facilities appears “properly” Title Cased, even Admin names.</p>
<pre class="r"><code>library(here)
library(knitr)
library(tidyverse)

data &lt;- read_csv(here(&quot;static&quot;, &quot;data&quot;, &quot;NFListing.csv&quot;)) %&gt;%
  select(nf_name,nf_loc_city) %&gt;%
  rename(name = nf_name, city = nf_loc_city) </code></pre>
</div>
<div id="teamtidyverse-take-1" class="section level2">
<h2>#TeamTidyverse &gt; Take 1</h2>
<p>In the Tidyverse, we can <a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a> data by multiple fields and see if the case matters. Our first opportunity to check the data occurs for Federal Way since there are both Title Case and ALL CAPS city and facility names.</p>
<pre class="r"><code>data %&gt;%
  arrange(city, name) %&gt;%
  select(city, name) %&gt;%
  kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">city</th>
<th align="left">name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Auburn</td>
<td align="left">Advanced Post Acute</td>
</tr>
<tr class="even">
<td align="left">Auburn</td>
<td align="left">Canterbury House</td>
</tr>
<tr class="odd">
<td align="left">Auburn</td>
<td align="left">Lea Hill Rehabilitation and Care Center</td>
</tr>
<tr class="even">
<td align="left">Auburn</td>
<td align="left">North Auburn Rehabilitation &amp; Health Center</td>
</tr>
<tr class="odd">
<td align="left">BELLEVUE</td>
<td align="left">MISSION HEALTHCARE AT BELLEVUE</td>
</tr>
<tr class="even">
<td align="left">BELLEVUE</td>
<td align="left">THE SPRINGS AT PACIFIC REGENT</td>
</tr>
<tr class="odd">
<td align="left">BURIEN</td>
<td align="left">Burien Nursing and Rehabilitation Center</td>
</tr>
<tr class="even">
<td align="left">DES MOINES</td>
<td align="left">JUDSON PARK HEALTH CENTER</td>
</tr>
<tr class="odd">
<td align="left">DES MOINES</td>
<td align="left">STAFFORD HEALTHCARE</td>
</tr>
<tr class="even">
<td align="left">DES MOINES</td>
<td align="left">WESLEY HOMES HEALTH CENTER</td>
</tr>
<tr class="odd">
<td align="left">Enumclaw</td>
<td align="left">Enumclaw Health and Rehabilitation Center</td>
</tr>
<tr class="even">
<td align="left">Federal Way</td>
<td align="left">Garden Terrace Healthcare Center of Federal Way</td>
</tr>
<tr class="odd">
<td align="left">Federal Way</td>
<td align="left">HALLMARK MANOR</td>
</tr>
<tr class="even">
<td align="left">Federal Way</td>
<td align="left">LIFE CARE CENTER OF FEDERAL WAY</td>
</tr>
<tr class="odd">
<td align="left">FEDERAL WAY</td>
<td align="left">AVALON CARE CENTER - FEDERAL WAY, LLC</td>
</tr>
<tr class="even">
<td align="left">Issaquah</td>
<td align="left">Briarwood at Timber Ridge</td>
</tr>
<tr class="odd">
<td align="left">ISSAQUAH</td>
<td align="left">Issaquah Nursing &amp; Rehabilitation Center</td>
</tr>
<tr class="even">
<td align="left">ISSAQUAH</td>
<td align="left">PROVIDENCE MARIANWOOD</td>
</tr>
<tr class="odd">
<td align="left">KENT</td>
<td align="left">BENSON HEIGHTS REHABILITATION CENTER</td>
</tr>
<tr class="even">
<td align="left">KENT</td>
<td align="left">SUNRISE HAVEN</td>
</tr>
<tr class="odd">
<td align="left">Kirkland</td>
<td align="left">LIFE CARE CENTER OF KIRKLAND</td>
</tr>
<tr class="even">
<td align="left">Mercer Island</td>
<td align="left">COVENANT SHORES HEALTH CENTER</td>
</tr>
<tr class="odd">
<td align="left">NORTH BEND</td>
<td align="left">Regency North Bend Rehabilitation and Nursing Center</td>
</tr>
<tr class="even">
<td align="left">Redmond</td>
<td align="left">REDMOND CARE AND REHABILITATION CENTER</td>
</tr>
<tr class="odd">
<td align="left">REDMOND</td>
<td align="left">CORWIN CENTER AT EMERALD HEIGHTS</td>
</tr>
<tr class="even">
<td align="left">Renton</td>
<td align="left">Mission Healthcare at Renton</td>
</tr>
<tr class="odd">
<td align="left">Renton</td>
<td align="left">Renton Nursing and Rehabilitation Center</td>
</tr>
<tr class="even">
<td align="left">RENTON</td>
<td align="left">Talbot Center for Rehabilitation and Healthcare</td>
</tr>
<tr class="odd">
<td align="left">Seattle</td>
<td align="left">BAILEY-BOUSHAY HOUSE</td>
</tr>
<tr class="even">
<td align="left">Seattle</td>
<td align="left">Ballard Center</td>
</tr>
<tr class="odd">
<td align="left">Seattle</td>
<td align="left">SAINT ANNE NURSING AND REHABILITATION CENTER</td>
</tr>
<tr class="even">
<td align="left">Seattle</td>
<td align="left">SEA MAR COMMUNITY CARE CENTER</td>
</tr>
<tr class="odd">
<td align="left">Seattle</td>
<td align="left">Seattle Medical Post Acute Care</td>
</tr>
<tr class="even">
<td align="left">Seattle</td>
<td align="left">Transitional Care Center of Seattle</td>
</tr>
<tr class="odd">
<td align="left">Seattle</td>
<td align="left">Washington Care Center</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">BAYVIEW MANOR</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">CAROLINE KLINE GALLAND HOME, THE</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">COLUMBIA LUTHERAN HOME</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">FOSS HOME AND VILLAGE</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">HEARTHSTONE, THE</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">KIN ON HEALTH CARE CENTER</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">MIRABELLA</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">PARK SHORE</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">Park West Care Center</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">PROVIDENCE MOUNT ST VINCENT</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">QUEEN ANNE HEALTHCARE</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">THE TERRACES AT SKYLINE</td>
</tr>
<tr class="even">
<td align="left">Shoreline</td>
<td align="left">FIRCREST SCHOOL PAT N</td>
</tr>
<tr class="odd">
<td align="left">Shoreline</td>
<td align="left">Park Ridge Care Center</td>
</tr>
<tr class="even">
<td align="left">Shoreline</td>
<td align="left">RICHMOND BEACH REHAB</td>
</tr>
<tr class="odd">
<td align="left">Shoreline</td>
<td align="left">SHORELINE HEALTH AND REHABILITATION</td>
</tr>
</tbody>
</table>
<p><strong><em>Observation:</em></strong>: Title Case city names precede ALL CAPS city names per AVALON CARE CENTER - FEDERAL WAY, LLC in FEDERAL WAY. Also true for REDMOND CARE AND REHABILITATION CENTER in REDMOND.</p>
</div>
<div id="data.table-take-1" class="section level2">
<h2>Data.Table &gt; Take 1</h2>
<p>My colleague who developed the allocation algorithm is on #TeamData.Table for zippy processing. To order data in a data.table we specify columns in <a href="https://www.rdocumentation.org/packages/data.table/versions/1.13.2/topics/setorder">setorder</a>.</p>
<pre class="r"><code>library(data.table)
dt_data  &lt;- fread(here(&quot;static&quot;, &quot;data&quot;, &quot;NFListing.csv&quot;))
da_table &lt;- dt_data[,.(city = nf_loc_city, name = nf_name)]
setorder(da_table, city, name)
da_table %&gt;%
  kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">city</th>
<th align="left">name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Auburn</td>
<td align="left">Advanced Post Acute</td>
</tr>
<tr class="even">
<td align="left">Auburn</td>
<td align="left">Canterbury House</td>
</tr>
<tr class="odd">
<td align="left">Auburn</td>
<td align="left">Lea Hill Rehabilitation and Care Center</td>
</tr>
<tr class="even">
<td align="left">Auburn</td>
<td align="left">North Auburn Rehabilitation &amp; Health Center</td>
</tr>
<tr class="odd">
<td align="left">BELLEVUE</td>
<td align="left">MISSION HEALTHCARE AT BELLEVUE</td>
</tr>
<tr class="even">
<td align="left">BELLEVUE</td>
<td align="left">THE SPRINGS AT PACIFIC REGENT</td>
</tr>
<tr class="odd">
<td align="left">BURIEN</td>
<td align="left">Burien Nursing and Rehabilitation Center</td>
</tr>
<tr class="even">
<td align="left">DES MOINES</td>
<td align="left">JUDSON PARK HEALTH CENTER</td>
</tr>
<tr class="odd">
<td align="left">DES MOINES</td>
<td align="left">STAFFORD HEALTHCARE</td>
</tr>
<tr class="even">
<td align="left">DES MOINES</td>
<td align="left">WESLEY HOMES HEALTH CENTER</td>
</tr>
<tr class="odd">
<td align="left">Enumclaw</td>
<td align="left">Enumclaw Health and Rehabilitation Center</td>
</tr>
<tr class="even">
<td align="left">FEDERAL WAY</td>
<td align="left">AVALON CARE CENTER - FEDERAL WAY, LLC</td>
</tr>
<tr class="odd">
<td align="left">Federal Way</td>
<td align="left">Garden Terrace Healthcare Center of Federal Way</td>
</tr>
<tr class="even">
<td align="left">Federal Way</td>
<td align="left">HALLMARK MANOR</td>
</tr>
<tr class="odd">
<td align="left">Federal Way</td>
<td align="left">LIFE CARE CENTER OF FEDERAL WAY</td>
</tr>
<tr class="even">
<td align="left">ISSAQUAH</td>
<td align="left">Issaquah Nursing &amp; Rehabilitation Center</td>
</tr>
<tr class="odd">
<td align="left">ISSAQUAH</td>
<td align="left">PROVIDENCE MARIANWOOD</td>
</tr>
<tr class="even">
<td align="left">Issaquah</td>
<td align="left">Briarwood at Timber Ridge</td>
</tr>
<tr class="odd">
<td align="left">KENT</td>
<td align="left">BENSON HEIGHTS REHABILITATION CENTER</td>
</tr>
<tr class="even">
<td align="left">KENT</td>
<td align="left">SUNRISE HAVEN</td>
</tr>
<tr class="odd">
<td align="left">Kirkland</td>
<td align="left">LIFE CARE CENTER OF KIRKLAND</td>
</tr>
<tr class="even">
<td align="left">Mercer Island</td>
<td align="left">COVENANT SHORES HEALTH CENTER</td>
</tr>
<tr class="odd">
<td align="left">NORTH BEND</td>
<td align="left">Regency North Bend Rehabilitation and Nursing Center</td>
</tr>
<tr class="even">
<td align="left">REDMOND</td>
<td align="left">CORWIN CENTER AT EMERALD HEIGHTS</td>
</tr>
<tr class="odd">
<td align="left">RENTON</td>
<td align="left">Talbot Center for Rehabilitation and Healthcare</td>
</tr>
<tr class="even">
<td align="left">Redmond</td>
<td align="left">REDMOND CARE AND REHABILITATION CENTER</td>
</tr>
<tr class="odd">
<td align="left">Renton</td>
<td align="left">Mission Healthcare at Renton</td>
</tr>
<tr class="even">
<td align="left">Renton</td>
<td align="left">Renton Nursing and Rehabilitation Center</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">BAYVIEW MANOR</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">CAROLINE KLINE GALLAND HOME, THE</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">COLUMBIA LUTHERAN HOME</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">FOSS HOME AND VILLAGE</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">HEARTHSTONE, THE</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">KIN ON HEALTH CARE CENTER</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">MIRABELLA</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">PARK SHORE</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">PROVIDENCE MOUNT ST VINCENT</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">Park West Care Center</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">QUEEN ANNE HEALTHCARE</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">THE TERRACES AT SKYLINE</td>
</tr>
<tr class="odd">
<td align="left">Seattle</td>
<td align="left">BAILEY-BOUSHAY HOUSE</td>
</tr>
<tr class="even">
<td align="left">Seattle</td>
<td align="left">Ballard Center</td>
</tr>
<tr class="odd">
<td align="left">Seattle</td>
<td align="left">SAINT ANNE NURSING AND REHABILITATION CENTER</td>
</tr>
<tr class="even">
<td align="left">Seattle</td>
<td align="left">SEA MAR COMMUNITY CARE CENTER</td>
</tr>
<tr class="odd">
<td align="left">Seattle</td>
<td align="left">Seattle Medical Post Acute Care</td>
</tr>
<tr class="even">
<td align="left">Seattle</td>
<td align="left">Transitional Care Center of Seattle</td>
</tr>
<tr class="odd">
<td align="left">Seattle</td>
<td align="left">Washington Care Center</td>
</tr>
<tr class="even">
<td align="left">Shoreline</td>
<td align="left">FIRCREST SCHOOL PAT N</td>
</tr>
<tr class="odd">
<td align="left">Shoreline</td>
<td align="left">Park Ridge Care Center</td>
</tr>
<tr class="even">
<td align="left">Shoreline</td>
<td align="left">RICHMOND BEACH REHAB</td>
</tr>
<tr class="odd">
<td align="left">Shoreline</td>
<td align="left">SHORELINE HEALTH AND REHABILITATION</td>
</tr>
</tbody>
</table>
<p><strong><em>Observation:</em></strong>: ALL CAPS city names precede Title Case city names per AVALON CARE CENTER - FEDERAL WAY, LLC in FEDERAL WAY. Things seem even weirder for REDMOND and RENTON where the 2 facilities with ALL CAPS cities precede the other 2 facilities in Redmond and Renton.</p>
</div>
<div id="what-to-do" class="section level2">
<h2>What to do?</h2>
<p>As a consultant, when discussing data quality, I would advocate for non-shouty data if source system flexibility makes that possible and doesn’t impact prior data reporting. But sometimes when you are downstream from data, you may find yourself getting inconsistently formatted data and you have to make the decision on how much you care about maddening cases and determine if you even have the time to invest in attempting to format names, which is often a tricky business.</p>
</div>
<div id="tidyverse-take-2" class="section level2">
<h2>#Tidyverse &gt; Take 2</h2>
<p>Rather than tackle facility names which may have initials and acronyms in ALL CAPS, formatting the city names will at least reveal where <code>dplyr::arrange</code> puts AVALON CARE CENTER - FEDERAL WAY, LLC once FEDERAL WAY is formatted.</p>
<pre class="r"><code>library(stringr)
data %&gt;%
  mutate(city_formatted = str_to_title(city)) %&gt;%
  arrange(city_formatted, name) %&gt;%
  select(city, city_formatted, name) %&gt;%
  kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">city</th>
<th align="left">city_formatted</th>
<th align="left">name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Auburn</td>
<td align="left">Auburn</td>
<td align="left">Advanced Post Acute</td>
</tr>
<tr class="even">
<td align="left">Auburn</td>
<td align="left">Auburn</td>
<td align="left">Canterbury House</td>
</tr>
<tr class="odd">
<td align="left">Auburn</td>
<td align="left">Auburn</td>
<td align="left">Lea Hill Rehabilitation and Care Center</td>
</tr>
<tr class="even">
<td align="left">Auburn</td>
<td align="left">Auburn</td>
<td align="left">North Auburn Rehabilitation &amp; Health Center</td>
</tr>
<tr class="odd">
<td align="left">BELLEVUE</td>
<td align="left">Bellevue</td>
<td align="left">MISSION HEALTHCARE AT BELLEVUE</td>
</tr>
<tr class="even">
<td align="left">BELLEVUE</td>
<td align="left">Bellevue</td>
<td align="left">THE SPRINGS AT PACIFIC REGENT</td>
</tr>
<tr class="odd">
<td align="left">BURIEN</td>
<td align="left">Burien</td>
<td align="left">Burien Nursing and Rehabilitation Center</td>
</tr>
<tr class="even">
<td align="left">DES MOINES</td>
<td align="left">Des Moines</td>
<td align="left">JUDSON PARK HEALTH CENTER</td>
</tr>
<tr class="odd">
<td align="left">DES MOINES</td>
<td align="left">Des Moines</td>
<td align="left">STAFFORD HEALTHCARE</td>
</tr>
<tr class="even">
<td align="left">DES MOINES</td>
<td align="left">Des Moines</td>
<td align="left">WESLEY HOMES HEALTH CENTER</td>
</tr>
<tr class="odd">
<td align="left">Enumclaw</td>
<td align="left">Enumclaw</td>
<td align="left">Enumclaw Health and Rehabilitation Center</td>
</tr>
<tr class="even">
<td align="left">FEDERAL WAY</td>
<td align="left">Federal Way</td>
<td align="left">AVALON CARE CENTER - FEDERAL WAY, LLC</td>
</tr>
<tr class="odd">
<td align="left">Federal Way</td>
<td align="left">Federal Way</td>
<td align="left">Garden Terrace Healthcare Center of Federal Way</td>
</tr>
<tr class="even">
<td align="left">Federal Way</td>
<td align="left">Federal Way</td>
<td align="left">HALLMARK MANOR</td>
</tr>
<tr class="odd">
<td align="left">Federal Way</td>
<td align="left">Federal Way</td>
<td align="left">LIFE CARE CENTER OF FEDERAL WAY</td>
</tr>
<tr class="even">
<td align="left">Issaquah</td>
<td align="left">Issaquah</td>
<td align="left">Briarwood at Timber Ridge</td>
</tr>
<tr class="odd">
<td align="left">ISSAQUAH</td>
<td align="left">Issaquah</td>
<td align="left">Issaquah Nursing &amp; Rehabilitation Center</td>
</tr>
<tr class="even">
<td align="left">ISSAQUAH</td>
<td align="left">Issaquah</td>
<td align="left">PROVIDENCE MARIANWOOD</td>
</tr>
<tr class="odd">
<td align="left">KENT</td>
<td align="left">Kent</td>
<td align="left">BENSON HEIGHTS REHABILITATION CENTER</td>
</tr>
<tr class="even">
<td align="left">KENT</td>
<td align="left">Kent</td>
<td align="left">SUNRISE HAVEN</td>
</tr>
<tr class="odd">
<td align="left">Kirkland</td>
<td align="left">Kirkland</td>
<td align="left">LIFE CARE CENTER OF KIRKLAND</td>
</tr>
<tr class="even">
<td align="left">Mercer Island</td>
<td align="left">Mercer Island</td>
<td align="left">COVENANT SHORES HEALTH CENTER</td>
</tr>
<tr class="odd">
<td align="left">NORTH BEND</td>
<td align="left">North Bend</td>
<td align="left">Regency North Bend Rehabilitation and Nursing Center</td>
</tr>
<tr class="even">
<td align="left">REDMOND</td>
<td align="left">Redmond</td>
<td align="left">CORWIN CENTER AT EMERALD HEIGHTS</td>
</tr>
<tr class="odd">
<td align="left">Redmond</td>
<td align="left">Redmond</td>
<td align="left">REDMOND CARE AND REHABILITATION CENTER</td>
</tr>
<tr class="even">
<td align="left">Renton</td>
<td align="left">Renton</td>
<td align="left">Mission Healthcare at Renton</td>
</tr>
<tr class="odd">
<td align="left">Renton</td>
<td align="left">Renton</td>
<td align="left">Renton Nursing and Rehabilitation Center</td>
</tr>
<tr class="even">
<td align="left">RENTON</td>
<td align="left">Renton</td>
<td align="left">Talbot Center for Rehabilitation and Healthcare</td>
</tr>
<tr class="odd">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">BAILEY-BOUSHAY HOUSE</td>
</tr>
<tr class="even">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">Ballard Center</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">BAYVIEW MANOR</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">CAROLINE KLINE GALLAND HOME, THE</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">COLUMBIA LUTHERAN HOME</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">FOSS HOME AND VILLAGE</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">HEARTHSTONE, THE</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">KIN ON HEALTH CARE CENTER</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">MIRABELLA</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">PARK SHORE</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">Park West Care Center</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">PROVIDENCE MOUNT ST VINCENT</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">QUEEN ANNE HEALTHCARE</td>
</tr>
<tr class="even">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">SAINT ANNE NURSING AND REHABILITATION CENTER</td>
</tr>
<tr class="odd">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">SEA MAR COMMUNITY CARE CENTER</td>
</tr>
<tr class="even">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">Seattle Medical Post Acute Care</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">THE TERRACES AT SKYLINE</td>
</tr>
<tr class="even">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">Transitional Care Center of Seattle</td>
</tr>
<tr class="odd">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">Washington Care Center</td>
</tr>
<tr class="even">
<td align="left">Shoreline</td>
<td align="left">Shoreline</td>
<td align="left">FIRCREST SCHOOL PAT N</td>
</tr>
<tr class="odd">
<td align="left">Shoreline</td>
<td align="left">Shoreline</td>
<td align="left">Park Ridge Care Center</td>
</tr>
<tr class="even">
<td align="left">Shoreline</td>
<td align="left">Shoreline</td>
<td align="left">RICHMOND BEACH REHAB</td>
</tr>
<tr class="odd">
<td align="left">Shoreline</td>
<td align="left">Shoreline</td>
<td align="left">SHORELINE HEALTH AND REHABILITATION</td>
</tr>
</tbody>
</table>
<p><strong><em>Verdict:</em></strong>: <strong><em>WINNER</em></strong></p>
<p>With my city data now formatted as Title Case, the secondary sorting of names is returned as hoped for both Federal Way, Redmond and Seattle facilities.</p>
</div>
<div id="data.table-take-2" class="section level2">
<h2>Data.Table &gt; Take 2</h2>
<pre class="r"><code># start over again with pre-ordered data.table
da_table &lt;- dt_data[,.(city = nf_loc_city, name = nf_name)]
da_table[,city_formatted := str_to_title(city)]

setorder(da_table, city_formatted, name)
da_table[,.(city, city_formatted, name)] %&gt;%
  kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">city</th>
<th align="left">city_formatted</th>
<th align="left">name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Auburn</td>
<td align="left">Auburn</td>
<td align="left">Advanced Post Acute</td>
</tr>
<tr class="even">
<td align="left">Auburn</td>
<td align="left">Auburn</td>
<td align="left">Canterbury House</td>
</tr>
<tr class="odd">
<td align="left">Auburn</td>
<td align="left">Auburn</td>
<td align="left">Lea Hill Rehabilitation and Care Center</td>
</tr>
<tr class="even">
<td align="left">Auburn</td>
<td align="left">Auburn</td>
<td align="left">North Auburn Rehabilitation &amp; Health Center</td>
</tr>
<tr class="odd">
<td align="left">BELLEVUE</td>
<td align="left">Bellevue</td>
<td align="left">MISSION HEALTHCARE AT BELLEVUE</td>
</tr>
<tr class="even">
<td align="left">BELLEVUE</td>
<td align="left">Bellevue</td>
<td align="left">THE SPRINGS AT PACIFIC REGENT</td>
</tr>
<tr class="odd">
<td align="left">BURIEN</td>
<td align="left">Burien</td>
<td align="left">Burien Nursing and Rehabilitation Center</td>
</tr>
<tr class="even">
<td align="left">DES MOINES</td>
<td align="left">Des Moines</td>
<td align="left">JUDSON PARK HEALTH CENTER</td>
</tr>
<tr class="odd">
<td align="left">DES MOINES</td>
<td align="left">Des Moines</td>
<td align="left">STAFFORD HEALTHCARE</td>
</tr>
<tr class="even">
<td align="left">DES MOINES</td>
<td align="left">Des Moines</td>
<td align="left">WESLEY HOMES HEALTH CENTER</td>
</tr>
<tr class="odd">
<td align="left">Enumclaw</td>
<td align="left">Enumclaw</td>
<td align="left">Enumclaw Health and Rehabilitation Center</td>
</tr>
<tr class="even">
<td align="left">FEDERAL WAY</td>
<td align="left">Federal Way</td>
<td align="left">AVALON CARE CENTER - FEDERAL WAY, LLC</td>
</tr>
<tr class="odd">
<td align="left">Federal Way</td>
<td align="left">Federal Way</td>
<td align="left">Garden Terrace Healthcare Center of Federal Way</td>
</tr>
<tr class="even">
<td align="left">Federal Way</td>
<td align="left">Federal Way</td>
<td align="left">HALLMARK MANOR</td>
</tr>
<tr class="odd">
<td align="left">Federal Way</td>
<td align="left">Federal Way</td>
<td align="left">LIFE CARE CENTER OF FEDERAL WAY</td>
</tr>
<tr class="even">
<td align="left">Issaquah</td>
<td align="left">Issaquah</td>
<td align="left">Briarwood at Timber Ridge</td>
</tr>
<tr class="odd">
<td align="left">ISSAQUAH</td>
<td align="left">Issaquah</td>
<td align="left">Issaquah Nursing &amp; Rehabilitation Center</td>
</tr>
<tr class="even">
<td align="left">ISSAQUAH</td>
<td align="left">Issaquah</td>
<td align="left">PROVIDENCE MARIANWOOD</td>
</tr>
<tr class="odd">
<td align="left">KENT</td>
<td align="left">Kent</td>
<td align="left">BENSON HEIGHTS REHABILITATION CENTER</td>
</tr>
<tr class="even">
<td align="left">KENT</td>
<td align="left">Kent</td>
<td align="left">SUNRISE HAVEN</td>
</tr>
<tr class="odd">
<td align="left">Kirkland</td>
<td align="left">Kirkland</td>
<td align="left">LIFE CARE CENTER OF KIRKLAND</td>
</tr>
<tr class="even">
<td align="left">Mercer Island</td>
<td align="left">Mercer Island</td>
<td align="left">COVENANT SHORES HEALTH CENTER</td>
</tr>
<tr class="odd">
<td align="left">NORTH BEND</td>
<td align="left">North Bend</td>
<td align="left">Regency North Bend Rehabilitation and Nursing Center</td>
</tr>
<tr class="even">
<td align="left">REDMOND</td>
<td align="left">Redmond</td>
<td align="left">CORWIN CENTER AT EMERALD HEIGHTS</td>
</tr>
<tr class="odd">
<td align="left">Redmond</td>
<td align="left">Redmond</td>
<td align="left">REDMOND CARE AND REHABILITATION CENTER</td>
</tr>
<tr class="even">
<td align="left">Renton</td>
<td align="left">Renton</td>
<td align="left">Mission Healthcare at Renton</td>
</tr>
<tr class="odd">
<td align="left">Renton</td>
<td align="left">Renton</td>
<td align="left">Renton Nursing and Rehabilitation Center</td>
</tr>
<tr class="even">
<td align="left">RENTON</td>
<td align="left">Renton</td>
<td align="left">Talbot Center for Rehabilitation and Healthcare</td>
</tr>
<tr class="odd">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">BAILEY-BOUSHAY HOUSE</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">BAYVIEW MANOR</td>
</tr>
<tr class="odd">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">Ballard Center</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">CAROLINE KLINE GALLAND HOME, THE</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">COLUMBIA LUTHERAN HOME</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">FOSS HOME AND VILLAGE</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">HEARTHSTONE, THE</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">KIN ON HEALTH CARE CENTER</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">MIRABELLA</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">PARK SHORE</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">PROVIDENCE MOUNT ST VINCENT</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">Park West Care Center</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">QUEEN ANNE HEALTHCARE</td>
</tr>
<tr class="even">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">SAINT ANNE NURSING AND REHABILITATION CENTER</td>
</tr>
<tr class="odd">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">SEA MAR COMMUNITY CARE CENTER</td>
</tr>
<tr class="even">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">Seattle Medical Post Acute Care</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">THE TERRACES AT SKYLINE</td>
</tr>
<tr class="even">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">Transitional Care Center of Seattle</td>
</tr>
<tr class="odd">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">Washington Care Center</td>
</tr>
<tr class="even">
<td align="left">Shoreline</td>
<td align="left">Shoreline</td>
<td align="left">FIRCREST SCHOOL PAT N</td>
</tr>
<tr class="odd">
<td align="left">Shoreline</td>
<td align="left">Shoreline</td>
<td align="left">Park Ridge Care Center</td>
</tr>
<tr class="even">
<td align="left">Shoreline</td>
<td align="left">Shoreline</td>
<td align="left">RICHMOND BEACH REHAB</td>
</tr>
<tr class="odd">
<td align="left">Shoreline</td>
<td align="left">Shoreline</td>
<td align="left">SHORELINE HEALTH AND REHABILITATION</td>
</tr>
</tbody>
</table>
<p><strong><em>Verdict:</em></strong>: <strong><em>BETTER</em></strong></p>
<p>Secondary sort on mixed case names results in facility names starting with a given letter in ALL CAPS preceding other Title Cased names of same letter.</p>
</div>
<div id="data.table-take-3" class="section level2">
<h2>Data.Table &gt; Take 3</h2>
<pre class="r"><code># start over again with pre-ordered data.table
da_table &lt;- dt_data[,.(city = nf_loc_city, name = nf_name)]
da_table[,city_formatted := str_to_title(city)]

da_table[base::order(city_formatted, name),.(city, city_formatted, name)] %&gt;%
  kable</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">city</th>
<th align="left">city_formatted</th>
<th align="left">name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Auburn</td>
<td align="left">Auburn</td>
<td align="left">Advanced Post Acute</td>
</tr>
<tr class="even">
<td align="left">Auburn</td>
<td align="left">Auburn</td>
<td align="left">Canterbury House</td>
</tr>
<tr class="odd">
<td align="left">Auburn</td>
<td align="left">Auburn</td>
<td align="left">Lea Hill Rehabilitation and Care Center</td>
</tr>
<tr class="even">
<td align="left">Auburn</td>
<td align="left">Auburn</td>
<td align="left">North Auburn Rehabilitation &amp; Health Center</td>
</tr>
<tr class="odd">
<td align="left">BELLEVUE</td>
<td align="left">Bellevue</td>
<td align="left">MISSION HEALTHCARE AT BELLEVUE</td>
</tr>
<tr class="even">
<td align="left">BELLEVUE</td>
<td align="left">Bellevue</td>
<td align="left">THE SPRINGS AT PACIFIC REGENT</td>
</tr>
<tr class="odd">
<td align="left">BURIEN</td>
<td align="left">Burien</td>
<td align="left">Burien Nursing and Rehabilitation Center</td>
</tr>
<tr class="even">
<td align="left">DES MOINES</td>
<td align="left">Des Moines</td>
<td align="left">JUDSON PARK HEALTH CENTER</td>
</tr>
<tr class="odd">
<td align="left">DES MOINES</td>
<td align="left">Des Moines</td>
<td align="left">STAFFORD HEALTHCARE</td>
</tr>
<tr class="even">
<td align="left">DES MOINES</td>
<td align="left">Des Moines</td>
<td align="left">WESLEY HOMES HEALTH CENTER</td>
</tr>
<tr class="odd">
<td align="left">Enumclaw</td>
<td align="left">Enumclaw</td>
<td align="left">Enumclaw Health and Rehabilitation Center</td>
</tr>
<tr class="even">
<td align="left">FEDERAL WAY</td>
<td align="left">Federal Way</td>
<td align="left">AVALON CARE CENTER - FEDERAL WAY, LLC</td>
</tr>
<tr class="odd">
<td align="left">Federal Way</td>
<td align="left">Federal Way</td>
<td align="left">Garden Terrace Healthcare Center of Federal Way</td>
</tr>
<tr class="even">
<td align="left">Federal Way</td>
<td align="left">Federal Way</td>
<td align="left">HALLMARK MANOR</td>
</tr>
<tr class="odd">
<td align="left">Federal Way</td>
<td align="left">Federal Way</td>
<td align="left">LIFE CARE CENTER OF FEDERAL WAY</td>
</tr>
<tr class="even">
<td align="left">Issaquah</td>
<td align="left">Issaquah</td>
<td align="left">Briarwood at Timber Ridge</td>
</tr>
<tr class="odd">
<td align="left">ISSAQUAH</td>
<td align="left">Issaquah</td>
<td align="left">Issaquah Nursing &amp; Rehabilitation Center</td>
</tr>
<tr class="even">
<td align="left">ISSAQUAH</td>
<td align="left">Issaquah</td>
<td align="left">PROVIDENCE MARIANWOOD</td>
</tr>
<tr class="odd">
<td align="left">KENT</td>
<td align="left">Kent</td>
<td align="left">BENSON HEIGHTS REHABILITATION CENTER</td>
</tr>
<tr class="even">
<td align="left">KENT</td>
<td align="left">Kent</td>
<td align="left">SUNRISE HAVEN</td>
</tr>
<tr class="odd">
<td align="left">Kirkland</td>
<td align="left">Kirkland</td>
<td align="left">LIFE CARE CENTER OF KIRKLAND</td>
</tr>
<tr class="even">
<td align="left">Mercer Island</td>
<td align="left">Mercer Island</td>
<td align="left">COVENANT SHORES HEALTH CENTER</td>
</tr>
<tr class="odd">
<td align="left">NORTH BEND</td>
<td align="left">North Bend</td>
<td align="left">Regency North Bend Rehabilitation and Nursing Center</td>
</tr>
<tr class="even">
<td align="left">REDMOND</td>
<td align="left">Redmond</td>
<td align="left">CORWIN CENTER AT EMERALD HEIGHTS</td>
</tr>
<tr class="odd">
<td align="left">Redmond</td>
<td align="left">Redmond</td>
<td align="left">REDMOND CARE AND REHABILITATION CENTER</td>
</tr>
<tr class="even">
<td align="left">Renton</td>
<td align="left">Renton</td>
<td align="left">Mission Healthcare at Renton</td>
</tr>
<tr class="odd">
<td align="left">Renton</td>
<td align="left">Renton</td>
<td align="left">Renton Nursing and Rehabilitation Center</td>
</tr>
<tr class="even">
<td align="left">RENTON</td>
<td align="left">Renton</td>
<td align="left">Talbot Center for Rehabilitation and Healthcare</td>
</tr>
<tr class="odd">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">BAILEY-BOUSHAY HOUSE</td>
</tr>
<tr class="even">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">Ballard Center</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">BAYVIEW MANOR</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">CAROLINE KLINE GALLAND HOME, THE</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">COLUMBIA LUTHERAN HOME</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">FOSS HOME AND VILLAGE</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">HEARTHSTONE, THE</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">KIN ON HEALTH CARE CENTER</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">MIRABELLA</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">PARK SHORE</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">Park West Care Center</td>
</tr>
<tr class="even">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">PROVIDENCE MOUNT ST VINCENT</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">QUEEN ANNE HEALTHCARE</td>
</tr>
<tr class="even">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">SAINT ANNE NURSING AND REHABILITATION CENTER</td>
</tr>
<tr class="odd">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">SEA MAR COMMUNITY CARE CENTER</td>
</tr>
<tr class="even">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">Seattle Medical Post Acute Care</td>
</tr>
<tr class="odd">
<td align="left">SEATTLE</td>
<td align="left">Seattle</td>
<td align="left">THE TERRACES AT SKYLINE</td>
</tr>
<tr class="even">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">Transitional Care Center of Seattle</td>
</tr>
<tr class="odd">
<td align="left">Seattle</td>
<td align="left">Seattle</td>
<td align="left">Washington Care Center</td>
</tr>
<tr class="even">
<td align="left">Shoreline</td>
<td align="left">Shoreline</td>
<td align="left">FIRCREST SCHOOL PAT N</td>
</tr>
<tr class="odd">
<td align="left">Shoreline</td>
<td align="left">Shoreline</td>
<td align="left">Park Ridge Care Center</td>
</tr>
<tr class="even">
<td align="left">Shoreline</td>
<td align="left">Shoreline</td>
<td align="left">RICHMOND BEACH REHAB</td>
</tr>
<tr class="odd">
<td align="left">Shoreline</td>
<td align="left">Shoreline</td>
<td align="left">SHORELINE HEALTH AND REHABILITATION</td>
</tr>
</tbody>
</table>
<p><strong><em>Verdict:</em></strong>: <strong><em>WINNER</em></strong></p>
<p>Specifying <code>base::order</code> makes the data.table sorting experience with dplyr and more importantly, sort more sensibly in spite of case differences across facility names. When reading all of the <a href="https://www.rdocumentation.org/packages/data.table/versions/1.13.2/topics/setorder">documentation</a>, it notes that -</p>
<blockquote>
<p>data.table always reorders in “C-locale”. As a consequence, the ordering may be different to that obtained by base::order.</p>
</blockquote>
</div>
<div id="a-sorted-affair" class="section level2">
<h2>A Sorted Affair</h2>
<p>As often is the case, thinking that a simple task to sort data won’t take more than 5 minutes can quickly lead one down a rabbit hole when data is inconsistent. Standardizing data formats for character values would not only be easier on human eyes, but also result in more expected sorting behavior.</p>
</div>
